# CSVæ—¥æœŸæ ¼å¼æ›´æ–°è¯´æ˜

## ğŸ“… æ›´æ–°å†…å®¹

å°†CSVè¾“å‡ºæ–‡ä»¶ä¸­çš„æ—¥æœŸæ ¼å¼ä»åŸæ¥çš„é•¿æ ¼å¼æ”¹ä¸ºç®€æ´çš„UTC+8æ—¶åŒºæ ¼å¼ã€‚

## ğŸ”„ æ ¼å¼å˜åŒ–

### ä¿®æ”¹å‰
```csv
symbol,date,open,high,low,close,volume,count,wap
MESU3,Wed Sep 06 2023 06:00:00 GMT+0800 (China Standard Time),4500.5,4501,4498.5,4499.25,699,228,4499.75
```

### ä¿®æ”¹å
```csv
symbol,date,open,high,low,close,volume,count,wap
MESU3,2023-09-06 06:00:00,4500.5,4501,4498.5,4499.25,699,228,4499.75
```

## âœ¨ æ”¹è¿›ä¼˜åŠ¿

1. **ç®€æ´æ˜“è¯»**: `YYYY-MM-DD HH:mm:ss` æ ¼å¼æ›´åŠ ç®€æ´
2. **æ ‡å‡†åŒ–**: ç¬¦åˆISO 8601æ ‡å‡†çš„æ—¥æœŸæ—¶é—´æ ¼å¼
3. **æ˜“äºå¤„ç†**: å¤§å¤šæ•°æ•°æ®åˆ†æå·¥å…·éƒ½èƒ½ç›´æ¥è¯†åˆ«è¿™ç§æ ¼å¼
4. **æ–‡ä»¶å¤§å°**: å‡å°‘äº†CSVæ–‡ä»¶çš„å¤§å°
5. **æ—¶åŒºä¸€è‡´**: ç»Ÿä¸€ä½¿ç”¨UTC+8æ—¶åŒºï¼ˆä¸­å›½æ ‡å‡†æ—¶é—´ï¼‰

## ğŸ› ï¸ æŠ€æœ¯å®ç°

### ä»£ç ä¿®æ”¹
```typescript
// åœ¨ appendDataToCSV æ–¹æ³•ä¸­æ·»åŠ æ—¥æœŸæ ¼å¼åŒ–
const csvRows = sortedData.map((item) => {
  // æ ¼å¼åŒ–æ—¥æœŸä¸ºUTC+8æ—¶åŒºçš„ YYYY-MM-DD HH:mm:ss æ ¼å¼
  const formattedDate = dayjs(item.date).utcOffset(8).format('YYYY-MM-DD HH:mm:ss');
  
  return [
    symbol,
    formattedDate,  // ä½¿ç”¨æ ¼å¼åŒ–åçš„æ—¥æœŸ
    item.open,
    item.high,
    item.low,
    item.close,
    item.volume,
    item.count || 0,
    item.wap || item.close,
  ].join(this.config.output.csvSeparator);
});
```

### ä¾èµ–æ›´æ–°
```typescript
import dayjs from "dayjs";
import utc from "dayjs/plugin/utc.js";

// æ‰©å±•dayjsä»¥æ”¯æŒUTCåç§»
dayjs.extend(utc);
```

## ğŸŒ æ—¶åŒºå¤„ç†

- **è¾“å…¥æ—¶é—´**: å¯èƒ½æ˜¯å„ç§æ ¼å¼ï¼ˆUTCã€æœ¬åœ°æ—¶é—´ç­‰ï¼‰
- **è¾“å‡ºæ—¶é—´**: ç»Ÿä¸€è½¬æ¢ä¸ºUTC+8æ—¶åŒº
- **æ ¼å¼**: `YYYY-MM-DD HH:mm:ss`

### æ—¶åŒºè½¬æ¢ç¤ºä¾‹
```
UTCæ—¶é—´: 2023-09-06T06:00:00.000Z
UTC+8æ—¶é—´: 2023-09-06 14:00:00

æœ¬åœ°æ—¶é—´: Wed Sep 06 2023 06:00:00 GMT+0800
UTC+8æ—¶é—´: 2023-09-06 06:00:00
```

## ğŸ“Š æ•°æ®å…¼å®¹æ€§

### Excel/Google Sheets
- âœ… ç›´æ¥è¯†åˆ«ä¸ºæ—¥æœŸæ—¶é—´æ ¼å¼
- âœ… æ”¯æŒæ—¥æœŸç­›é€‰å’Œæ’åº
- âœ… å¯ç”¨äºæ—¶é—´åºåˆ—å›¾è¡¨

### Python pandas
```python
import pandas as pd

# ç›´æ¥è¯»å–ï¼Œpandasä¼šè‡ªåŠ¨è¯†åˆ«æ—¥æœŸæ ¼å¼
df = pd.read_csv('MES_1min_historical_MESZ3_20250830.csv')
df['date'] = pd.to_datetime(df['date'])
```

### æ•°æ®åº“å¯¼å…¥
- âœ… MySQL: ç›´æ¥å…¼å®¹ `DATETIME` ç±»å‹
- âœ… PostgreSQL: å…¼å®¹ `TIMESTAMP` ç±»å‹
- âœ… SQLite: å…¼å®¹æ—¥æœŸæ—¶é—´å‡½æ•°

## ğŸ”„ å‘åå…¼å®¹

### ç°æœ‰æ–‡ä»¶
- å·²ç”Ÿæˆçš„CSVæ–‡ä»¶ä¿æŒåŸæ ¼å¼ä¸å˜
- æ–°ç”Ÿæˆçš„æ•°æ®å°†ä½¿ç”¨æ–°æ ¼å¼
- å¦‚éœ€ç»Ÿä¸€æ ¼å¼ï¼Œå¯é‡æ–°ç”Ÿæˆæ•°æ®

### æ•°æ®å¤„ç†å»ºè®®
```python
# å¤„ç†æ··åˆæ ¼å¼çš„æ—¥æœŸ
import pandas as pd
from dateutil import parser

def parse_mixed_dates(date_str):
    try:
        # å°è¯•è§£ææ–°æ ¼å¼
        return pd.to_datetime(date_str, format='%Y-%m-%d %H:%M:%S')
    except:
        # å›é€€åˆ°é€šç”¨è§£æå™¨
        return pd.to_datetime(date_str)

df['date'] = df['date'].apply(parse_mixed_dates)
```

## ğŸ“‹ ä½¿ç”¨è¯´æ˜

### æ–°ç”Ÿæˆçš„æ•°æ®
- æ‰€æœ‰æ–°è·å–çš„å†å²æ•°æ®éƒ½å°†ä½¿ç”¨æ–°çš„æ—¥æœŸæ ¼å¼
- æ—¶åŒºç»Ÿä¸€ä¸ºUTC+8ï¼ˆä¸­å›½æ ‡å‡†æ—¶é—´ï¼‰
- æ ¼å¼ä¸º `YYYY-MM-DD HH:mm:ss`

### é…ç½®é€‰é¡¹
ç›®å‰æ—¥æœŸæ ¼å¼æ˜¯å›ºå®šçš„ï¼Œå¦‚éœ€è‡ªå®šä¹‰å¯åœ¨é…ç½®ä¸­æ·»åŠ ï¼š
```typescript
// æœªæ¥å¯èƒ½çš„é…ç½®é€‰é¡¹
export interface MESFetcherConfig {
  output: {
    dateFormat?: string;      // æ—¥æœŸæ ¼å¼
    timezone?: string;        // æ—¶åŒºè®¾ç½®
    // ...å…¶ä»–é…ç½®
  };
}
```

## ğŸ§ª æµ‹è¯•éªŒè¯

å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼éªŒè¯æ—¥æœŸæ ¼å¼ï¼š

1. **æŸ¥çœ‹CSVæ–‡ä»¶**:
   ```bash
   head -5 MES_1min_historical_*.csv
   ```

2. **æ£€æŸ¥æ—¥æœŸæ ¼å¼**:
   ```bash
   # åº”è¯¥çœ‹åˆ°ç±»ä¼¼ 2023-09-06 06:00:00 çš„æ ¼å¼
   cut -d',' -f2 MES_1min_historical_*.csv | head -5
   ```

3. **éªŒè¯æ—¶åŒºè½¬æ¢**:
   - ç¡®è®¤æ—¶é—´æ˜¯å¦ä¸ºUTC+8æ—¶åŒº
   - æ£€æŸ¥æ˜¯å¦æœ‰æ—¶åŒºåç§»é”™è¯¯

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **æ—¶åŒºä¸€è‡´æ€§**: æ‰€æœ‰æ—¶é—´éƒ½è½¬æ¢ä¸ºUTC+8ï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§
2. **æ ¼å¼æ ‡å‡†**: ä½¿ç”¨ISO 8601å…¼å®¹çš„æ ¼å¼
3. **æ•°æ®ç²¾åº¦**: ä¿æŒåˆ†é’Ÿçº§ç²¾åº¦ï¼Œç¬¦åˆ1åˆ†é’ŸKçº¿æ•°æ®è¦æ±‚
4. **å…¼å®¹æ€§**: æ–°æ ¼å¼ä¸ä¸»æµæ•°æ®åˆ†æå·¥å…·å…¼å®¹

## ğŸ”® æœªæ¥æ”¹è¿›

1. **å¯é…ç½®æ—¶åŒº**: å…è®¸ç”¨æˆ·è‡ªå®šä¹‰è¾“å‡ºæ—¶åŒº
2. **å¤šç§æ ¼å¼**: æ”¯æŒå¤šç§æ—¥æœŸæ ¼å¼é€‰é¡¹
3. **æ—¶åŒºæ ‡è¯†**: åœ¨æ—¥æœŸå­—ç¬¦ä¸²ä¸­åŒ…å«æ—¶åŒºä¿¡æ¯ï¼ˆå¦‚ `+08:00`ï¼‰
